select(Asset, sd_avg) %>%
unique()
left_join(week_st_3, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year)
Return
Return <- read_excel("~/Library/CloudStorage/OneDrive-KøbenhavnsUniversitet/Uni/6. År/PFO2025/Return.xlsx",col_types = c("date", "text", "numeric", "numeric"))
View(Return)
levels(Return$Asset)
lst(Return$Asset)
Returns %>% filter(Asset = "Jyske Portefølje Dæmpet Akk KL")
Return %>% filter(Asset = "Jyske Portefølje Dæmpet Akk KL")
Return %>% filter(Asset == "Jyske Portefølje Dæmpet Akk KL")
View(Return %>% select(Asset) %>% unique())
library(tidyverse)
Return <- read_excel("~/Library/CloudStorage/OneDrive-KøbenhavnsUniversitet/Uni/6. År/PFO2025/Return.xlsx",col_types = c("date", "text", "numeric", "numeric"))
Return = Return %>% select(c(Date, Asset, Return)) %>% filter(Asset %in% c("Jyske Portefølje Vækst Akk KL","Jyske Portefølje Balanceret Akk KL","Jyske Portefølje Stabil Akk KL","Jyske Portefølje Dæmpet akk KL"))
# 3 år tilbage
## Mean return
### Rigtig
year_avg_ret_3 = Return %>%
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
summarise(mean_ret = prod(1+Return)-1)
### Sus til sammenligning
week_avg_ret_3 = Return %>%
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
summarise(mean_ret = mean(Return))
n_weeks = Return %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
mutate(n_weeks = n()) %>%
select(Asset, Year, n_weeks) %>%
unique()
year_avg_ret_3_sus = left_join(week_avg_ret_3, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(mean_ret_year = (mean_ret+1)**n_weeks - 1) %>%
select(c(Asset, Year, mean_ret_year)) %>%
unique()
## Std
week_st_3 = Return %>%
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
mutate(sd = sqrt(mean((Return - mean(Return))**2)))
year_svg_sd_3 = left_join(week_st_3, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(sd_year = sd*sqrt(n_weeks)) %>%
select(c(Asset, Year, sd_year)) %>%
unique() %>%
ungroup() %>%
group_by(Asset) %>%
mutate(sd_avg = mean(sd_year)) %>%
select(Asset, sd_avg) %>%
unique()
week_avg_ret_3
### Sus til sammenligning
week_avg_ret_3 = Return %>%
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
summarise(mean_ret = mean(Return))
week_avg_ret_3
n_weeks = Return %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
mutate(n_weeks = n()) %>%
select(Asset, Year, n_weeks) %>%
unique()
n_weeks
year_avg_ret_3_sus = left_join(week_avg_ret_3, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(mean_ret_year = (mean_ret+1)**n_weeks - 1) %>%
select(c(Asset, Year, mean_ret_year)) %>%
unique() %>%
ungroup() %>%
group_by(Asset) %>%
mutate(mean(mean_ret_year))
year_avg_ret_3_sus
select(Asset, avg_ret) %>%
uniquq()
select(Asset, avg_ret) %>%
unique()
year_avg_ret_3_sus = left_join(week_avg_ret_3, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(mean_ret_year = (mean_ret+1)**n_weeks - 1) %>%
select(c(Asset, Year, mean_ret_year)) %>%
unique() %>%
ungroup() %>%
group_by(Asset) %>%
mutate(avg_ret = mean(mean_ret_year)) %>%
select(Asset, avg_ret) %>%
unique()
year_avg_ret_3_sus
left_join(week_avg_ret_3, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(mean_ret_year = (mean_ret+1)**n_weeks - 1) %>%
select(c(Asset, Year, mean_ret_year)) %>%
unique() %>%
ungroup()
Return <- read_excel("~/Library/CloudStorage/OneDrive-KøbenhavnsUniversitet/Uni/6. År/PFO2025/Return.xlsx",col_types = c("date", "text", "numeric", "numeric"))
Return = Return %>% select(c(Date, Asset, Return)) %>% filter(Asset %in% c("Jyske Portefølje Vækst Akk KL","Jyske Portefølje Balanceret Akk KL","Jyske Portefølje Stabil Akk KL","Jyske Portefølje Dæmpet akk KL"))
# 3 år tilbage
## Mean return
### Mean return by compounding indiviual weekly return
year_avg_ret_3 = Return %>%
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
summarise(mean_ret = prod(1+Return)-1)
year_avg_ret_3
year_avg_ret_3 = Return %>%
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
summarise(mean_week_ret = prod(1+Return)-1)
year_avg_ret_3
### Mean return by compounding indiviual weekly return
year_avg_ret_3 = Return %>%
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
summarise(mean_week_ret = prod(1+Return)-1) %>%
ungroup()
year_avg_ret_3
### Mean return by compound the average weekly returns
week_avg_ret_3 = Return %>%
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
summarise(mean_week_ret = mean(Return))
week_avg_ret_3
### Mean return by compounding indiviual weekly return
correct_week_avg_ret_3 = Return %>%
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
summarise(mean_week_ret = prod(1+Return)-1) %>%
ungroup()
### Mean return by compound the average weekly returns
week_avg_ret_3 = Return %>%
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
summarise(mean_week_ret = mean(Return)) %>%
ungroup()
week_avg_ret_3
### Mean return by compounding indiviual weekly return
individual_yearly_avg_ret_3 = Return %>%
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
summarise(mean_week_ret = prod(1+Return)-1) %>%
ungroup()
Return %>%
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
summarise(mean_week_ret = mean(Return)) %>%
ungroup()
Return %>%
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
summarise(mean_week_ret = mean(Return)) %>%
ungroup()
Return %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
mutate(n_weeks = n()) %>%
select(Asset, Year, n_weeks) %>%
unique()
left_join(week_avg_ret_3, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(mean_ret_year = (mean_ret+1)**n_weeks - 1) %>%
select(c(Asset, Year, mean_ret_year)) %>%
unique() %>%
ungroup() %>%
group_by(Asset) %>%
mutate(avg_ret = mean(mean_ret_year)) %>%
select(Asset, avg_ret) %>%
unique()
left_join(week_avg_ret_3, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(mean_ret_year = (mean_ret+1)**n_weeks - 1) %>%
select(c(Asset, Year, mean_ret_year)) %>%
unique() %>%
ungroup() %>%
group_by(Asset)
left_join(week_avg_ret_3, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(mean_ret_year = (mean_ret+1)**n_weeks - 1) %>%
select(c(Asset, Year, mean_ret_year)) %>%
unique() %>%
ungroup()
week_avg_ret_3
n_weeks
left_join(week_avg_ret_3, n_weeks, by = c("Year", "Asset")) %>%
group_by(Asset, Year)
left_join(week_avg_ret_3, n_weeks, by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(mean_ret_year = (mean_week_ret+1)**n_weeks - 1)
left_join(week_avg_ret_3, n_weeks, by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(mean_ret_year = (mean_week_ret+1)**n_weeks - 1) %>%
select(c(Asset, Year, mean_ret_year))
left_join(week_avg_ret_3, n_weeks, by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(mean_ret_year = (mean_week_ret+1)**n_weeks - 1) %>%
select(c(Asset, Year, mean_ret_year)) %>%
unique() %>%
ungroup() %>%
group_by(Asset) %>%
mutate(avg_ret = mean(mean_ret_year)) %>%
select(Asset, avg_ret)
left_join(week_avg_ret_3, n_weeks, by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(mean_ret_year = (mean_week_ret+1)**n_weeks - 1) %>%
select(c(Asset, Year, mean_ret_year)) %>%
unique() %>%
ungroup() %>%
group_by(Asset) %>%
mutate(avg_ret = mean(mean_ret_year)) %>%
select(Asset, avg_ret) %>%
unique()
Return %>%
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
mutate(sd = sqrt(mean((Return - mean(Return))**2)))
Return %>%
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
mutate(sd = sqrt(mean((Return - mean(Return))**2)))
left_join(week_st_3, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year)
left_join(week_st_3, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(sd_year = sd*sqrt(n_weeks))
left_join(week_st_3, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(sd_year = sd*sqrt(n_weeks)) %>%
select(c(Asset, Year, sd_year)) %>%
unique()
left_join(week_st_3, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(sd_year = sd*sqrt(n_weeks)) %>%
select(c(Asset, Year, sd_year)) %>%
unique() %>%
ungroup() %>%
group_by(Asset) %>%
mutate(sd_avg = mean(sd_year)) %>%
select(Asset, sd_avg) %>%
unique()
install.packages("PerformanceAnalytics")
library(PerformanceAnalytics)
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
mutate(CVaR = CVaR(returns, p = 0.95, method = "historical"))
Return %>%
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
mutate(CVaR = CVaR(returns, p = 0.95, method = "historical"))
Return %>%
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
mutate(CVaR = CVaR(returns, p = 0.95, method = "historical"))
Return
Return %>%
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
mutate(CVaR = CVaR(Return, p = 0.99, method = "historical"))
Return %>%
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
mutate(VaR = VaR(Return, p = 0.99, method = "historical")) %>%
mutate(CVaR = CVaR(Return, p = 0.99, method = "historical"))
week_cvar_3 = Return %>%
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
mutate(CVaR = CVaR(Return, p = 0.99, method = "historical"))
left_join(week_cvar_3, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(CVaR = (1+CVaR)**n_weeks - 1)
left_join(week_cvar_3, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(CVaR = (1+CVaR)**n_weeks - 1) %>%
select(c(Asset, Year, CVaR)) %>%
unique() %>%
ungroup() %>%
group_by(Asset) %>%
mutate(CVaR = mean(CVaR)) %>%
select(Asset, CVaR) %>%
unique()
left_join(week_cvar_3, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(CVaR = (1+CVaR)**n_weeks - 1) %>%
select(c(Asset, Year, CVaR)) %>%
unique() %>%
ungroup() %>%
group_by(Asset) %>%
mutate(CVaR = mean(CVaR)) %>%
select(Asset, CVaR) %>%
unique()
week_cvar_3 = Return %>%
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
mutate(CVaR = CVaR(Return, p = 0.95, method = "historical"))
year_svg_cvar_3 = left_join(week_cvar_3, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(CVaR = (1+CVaR)**n_weeks - 1) %>%
select(c(Asset, Year, CVaR)) %>%
unique() %>%
ungroup() %>%
group_by(Asset) %>%
mutate(CVaR = mean(CVaR)) %>%
select(Asset, CVaR) %>%
unique()
year_svg_cvar_3
year_svg_cvar_3
week_cvar_3 = Return %>%
filter(year(Date) >= 2022 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
mutate(CVaR = CVaR(Return, p = 0.99, method = "historical"))
year_svg_cvar_3 = left_join(week_cvar_3, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(CVaR = (1+CVaR)**n_weeks - 1) %>%
select(c(Asset, Year, CVaR)) %>%
unique() %>%
ungroup() %>%
group_by(Asset) %>%
mutate(CVaR = mean(CVaR)) %>%
select(Asset, CVaR) %>%
unique()
year_svg_cvar_3
### Mean return by compounding indiviual weekly return
individual_yearly_avg_ret_5 = Return %>%
filter(year(Date) >= 2020 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
summarise(mean_week_ret = prod(1+Return)-1) %>%
ungroup()
individual_yearly_avg_ret_5
individual_yearly_avg_ret_3
### Mean return by compound the average weekly returns
week_avg_ret_5 = Return %>%
filter(year(Date) >= 2020 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
summarise(mean_week_ret = mean(Return)) %>%
ungroup()
year_avg_ret_5_sus = left_join(week_avg_ret_5, n_weeks, by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(mean_ret_year = (mean_week_ret+1)**n_weeks - 1) %>%
select(c(Asset, Year, mean_ret_year)) %>%
unique() %>%
ungroup() %>%
group_by(Asset) %>%
mutate(avg_ret = mean(mean_ret_year)) %>%
select(Asset, avg_ret) %>%
unique()
year_avg_ret_5_sus
### Mean return by compounding indiviual weekly return------
individual_yearly_avg_ret_5 = Return %>%
filter(year(Date) >= 2020 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
summarise(mean_week_ret = prod(1+Return)-1) %>%
ungroup()
individual_yearly_avg_ret_5
year_avg_ret_5_sus
year_avg_ret_3_sus
week_st_5 = Return %>%
filter(year(Date) >= 2020 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
mutate(sd = sqrt(mean((Return - mean(Return))**2)))
year_svg_sd_5 = left_join(week_st_5, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(sd_year = sd*sqrt(n_weeks)) %>%
select(c(Asset, Year, sd_year)) %>%
unique() %>%
ungroup() %>%
group_by(Asset) %>%
mutate(sd_avg = mean(sd_year)) %>%
select(Asset, sd_avg) %>%
unique()
year_svg_sd_5
year_svg_sd_3
week_cvar_5 = Return %>%
filter(year(Date) >= 2020 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
mutate(CVaR = CVaR(Return, p = 0.99, method = "historical"))
year_svg_cvar_5 = left_join(week_cvar_3, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(CVaR = (1+CVaR)**n_weeks - 1) %>%
select(c(Asset, Year, CVaR)) %>%
unique() %>%
ungroup() %>%
group_by(Asset) %>%
mutate(CVaR = mean(CVaR)) %>%
select(Asset, CVaR) %>%
unique()
year_svg_cvar_5
year_svg_cvar_5 = left_join(week_cvar_5, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(CVaR = (1+CVaR)**n_weeks - 1) %>%
select(c(Asset, Year, CVaR)) %>%
unique() %>%
ungroup() %>%
group_by(Asset) %>%
mutate(CVaR = mean(CVaR)) %>%
select(Asset, CVaR) %>%
unique()
year_svg_cvar_5
year_svg_cvar_3
### Mean return by compounding indiviual weekly return------
individual_yearly_avg_ret_10 = Return %>%
filter(year(Date) >= 2015 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
summarise(mean_week_ret = prod(1+Return)-1) %>%
ungroup()
### Mean return by compound the average weekly returns------
week_avg_ret_10 = Return %>%
filter(year(Date) >= 2015 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
summarise(mean_week_ret = mean(Return)) %>%
ungroup()
year_avg_ret_10_sus = left_join(week_avg_ret_10, n_weeks, by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(mean_ret_year = (mean_week_ret+1)**n_weeks - 1) %>%
select(c(Asset, Year, mean_ret_year)) %>%
unique() %>%
ungroup() %>%
group_by(Asset) %>%
mutate(avg_ret = mean(mean_ret_year)) %>%
select(Asset, avg_ret) %>%
unique()
year_avg_ret_10_sus
week_st_10 = Return %>%
filter(year(Date) >= 2015 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
mutate(sd = sqrt(mean((Return - mean(Return))**2)))
year_svg_sd_10 = left_join(week_st_10, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(sd_year = sd*sqrt(n_weeks)) %>%
select(c(Asset, Year, sd_year)) %>%
unique() %>%
ungroup() %>%
group_by(Asset) %>%
mutate(sd_avg = mean(sd_year)) %>%
select(Asset, sd_avg) %>%
unique()
year_svg_sd_10
week_cvar_10 = Return %>%
filter(year(Date) >= 2015 & year(Date) <= 2024) %>%
mutate(Year = year(Date)) %>%
group_by(Asset, Year) %>%
mutate(CVaR = CVaR(Return, p = 0.99, method = "historical"))
year_svg_cvar_10 = left_join(week_cvar_10, n_weeks,by = c("Year", "Asset")) %>%
group_by(Asset, Year) %>%
mutate(CVaR = (1+CVaR)**n_weeks - 1) %>%
select(c(Asset, Year, CVaR)) %>%
unique() %>%
ungroup() %>%
group_by(Asset) %>%
mutate(CVaR = mean(CVaR)) %>%
select(Asset, CVaR) %>%
unique()
year_svg_cvar_10
year_avg_ret_3_sus
year_avg_ret_5_sus
year_avg_ret_10_sus
year_svg_sd_3
year_svg_sd_5
year_svg_sd_10
year_svg_cvar_3
year_svg_cvar_5
year_svg_cvar_10
year_avg_ret_3_sus
year_avg_ret_5_sus
year_avg_ret_10_sus
year_svg_sd_3
year_svg_sd_5
year_svg_sd_10
year_svg_cvar_3
year_svg_cvar_5
year_svg_cvar_10
year_avg_ret_3_sus
year_avg_ret_5_sus
year_avg_ret_10_sus
year_svg_sd_3
year_svg_sd_5
year_svg_sd_10
year_svg_cvar_3
year_svg_cvar_5
year_svg_cvar_10
